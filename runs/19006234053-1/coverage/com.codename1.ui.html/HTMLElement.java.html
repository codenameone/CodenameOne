<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>HTMLElement.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">codenameone-core-unittests</a> &gt; <a href="index.source.html" class="el_package">com.codename1.ui.html</a> &gt; <span class="el_source">HTMLElement.java</span></div><h1>HTMLElement.java</h1><pre class="source lang-java linenums">/*
 * Copyright (c) 2008, 2010, Oracle and/or its affiliates. All rights reserved.
 * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
 * This code is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License version 2 only, as
 * published by the Free Software Foundation.  Oracle designates this
 * particular file as subject to the &quot;Classpath&quot; exception as provided
 * by Oracle in the LICENSE file that accompanied this code.
 *
 * This code is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
 * version 2 for more details (a copy is included in the LICENSE file that
 * accompanied this code).
 *
 * You should have received a copy of the GNU General Public License version
 * 2 along with this work; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.
 *
 * Please contact Oracle, 500 Oracle Parkway, Redwood Shores
 * CA 94065 USA or visit www.oracle.com if you need additional information or
 * have any questions.
 */
package com.codename1.ui.html;

import com.codename1.ui.Component;
import com.codename1.xml.Element;

import java.util.Enumeration;
import java.util.Hashtable;
import java.util.Vector;

/**
 * The HTMLElement class defines a single HTML element with its attributes and children.
 * Due to its hierarchial nature, this class can be used for a single &quot;leaf&quot; Element, for more complex elements (with child elements), and up to describing the entire document.
 *
 * @author Ofir Leitner
 */
public class HTMLElement extends Element {

//////////////////////////////////
// Tags                         //
    /// ///////////////////////////////

    //HTML Tag ID codes:
    public static final int TAG_CSS_ILLEGAL_SELECTOR = -3; // If this is the tag ID it means this selector was malformed and as such will never match (For example p[] or a[=] - empty/meaningless attribute selection). Note that we can't simply discard this selector for the case of descendants: for example 'h1 a[] h2' - should never be matched - if we would discard the a[] which is illegal we would get 'h1 h2' which may be matched
    public static final int TAG_CSS_SELECTOR = -2;
    public static final int TAG_UNSUPPORTED = -1;

    //Structure Module
    public static final int TAG_BODY = 0;
    public static final int TAG_HEAD = 1;
    public static final int TAG_HTML = 2;
    public static final int TAG_TITLE = 3;

    //Text Module -
    public static final int TAG_ABBR = 4;    // No visual effect
    public static final int TAG_ACRONYM = 5; // No visual effect
    public static final int TAG_ADDRESS = 6; // No visual effect
    public static final int TAG_BLOCKQUOTE = 7;
    public static final int TAG_BR = 8;
    public static final int TAG_CITE = 9;
    public static final int TAG_CODE = 10;
    public static final int TAG_DFN = 11;
    public static final int TAG_DIV = 12;
    public static final int TAG_EM = 13;
    public static final int TAG_H1 = 14;
    public static final int TAG_H2 = 15;
    public static final int TAG_H3 = 16;
    public static final int TAG_H4 = 17;
    public static final int TAG_H5 = 18;
    public static final int TAG_H6 = 19;
    public static final int TAG_KBD = 20;
    public static final int TAG_P = 21;
    public static final int TAG_PRE = 22;
    public static final int TAG_Q = 23;
    public static final int TAG_SAMP = 24;
    public static final int TAG_SPAN = 25;   // While this is not parsed, it will be kept in the DOM and as such CSS will affect its class/ID
    public static final int TAG_STRONG = 26;
    public static final int TAG_VAR = 27;

    //Hypertext Module -
    public static final int TAG_A = 28;

    //List Module -
    public static final int TAG_DL = 29;
    public static final int TAG_DT = 30;
    public static final int TAG_DD = 31;
    public static final int TAG_OL = 32;
    public static final int TAG_UL = 33;
    public static final int TAG_LI = 34;

//Basic Forms Module -

    public static final int TAG_FORM = 35;
    public static final int TAG_INPUT = 36;
    public static final int TAG_LABEL = 37;
    public static final int TAG_SELECT = 38;
    public static final int TAG_OPTION = 39;
    public static final int TAG_TEXTAREA = 40;

    //Basic Tables Module -
    public static final int TAG_CAPTION = 41;
    public static final int TAG_TABLE = 42;
    public static final int TAG_TD = 43;
    public static final int TAG_TH = 44;
    public static final int TAG_TR = 45;

    //Image Module -
    public static final int TAG_IMG = 46;

    //Object Module -
    public static final int TAG_OBJECT = 47; // Not supported
    public static final int TAG_PARAM = 48;  // Not supported

    //Metainformation Module
    public static final int TAG_META = 49;

    //Link Module -
    public static final int TAG_LINK = 50;

    //Base Module
    public static final int TAG_BASE = 51;

    //XHTML Mobile Profile additons
    public static final int TAG_HR = 52;
    public static final int TAG_OPTGROUP = 53; // Currently still not supported as Codename One's ComboBox can't display option groups, but will display as a regular ComboBox
    public static final int TAG_STYLE = 54;
    public static final int TAG_B = 55;
    public static final int TAG_I = 56;
    public static final int TAG_BIG = 57;
    public static final int TAG_SMALL = 58;
    public static final int TAG_FIELDSET = 59;

    // HTML 4 tags - the following tags are not part of the XHTML MP 1.0 standard:

    public static final int TAG_U = 60; // Underline
    public static final int TAG_FONT = 61;
    public static final int TAG_DEL = 62; // Rendered same as S
    public static final int TAG_INS = 63; // Rendered same as U
    public static final int TAG_TT = 64;
    public static final int TAG_BASEFONT = 65;
    public static final int TAG_MENU = 66; // Same as UL
    public static final int TAG_S = 67; // Strike through
    public static final int TAG_STRIKE = 68; // Strike through
    public static final int TAG_CENTER = 69; // shorthand for DIV align=center
    public static final int TAG_DIR = 70;// Same as UL
    public static final int TAG_MAP = 71;
    public static final int TAG_AREA = 72;
    public static final int TAG_LEGEND = 73;
    public static final int TAG_SUB = 74;
    public static final int TAG_SUP = 75;
    public static final int TAG_NOSCRIPT = 76; // Since we don't support scripts this tag will always be evaluated
    public static final int TAG_NOFRAMES = 77; // Since we don't support frames this tag will always be evaluated
    public static final int TAG_THEAD = 78;
    public static final int TAG_TBODY = 79;
    public static final int TAG_TFOOT = 80;

    public static final int TAG_BUTTON = 81;
    //Text nodes (not an actual tag - text segments are added by the parser as the 'text' tag
    public static final int TAG_TEXT = 82;
    /// ///////////////////////////////

//Tag attributes:
    public static final int ATTR_CLASS = 0;
    public static final int ATTR_ID = 1;


//////////////////////////////////
// Attributes                   //
    public static final int ATTR_STYLE = 2;
    public static final int ATTR_TITLE = 3;
    public static final int ATTR_XMLNS = 4;
    public static final int ATTR_XMLLANG = 5;
    public static final int ATTR_ALIGN = 6;
    public static final int ATTR_BGCOLOR = 7;
    public static final int ATTR_LINK = 8;
    public static final int ATTR_TEXT = 9;
    public static final int ATTR_VERSION = 10;
    public static final int ATTR_CITE = 11;
    public static final int ATTR_ACCESSKEY = 12;
    public static final int ATTR_CHARSET = 13;
    public static final int ATTR_HREF = 14;
    public static final int ATTR_HREFLANG = 15;
    public static final int ATTR_REL = 16;
    public static final int ATTR_REV = 17;
    public static final int ATTR_TABINDEX = 18;
    public static final int ATTR_TYPE = 19;
    public static final int ATTR_ACTION = 20;
    public static final int ATTR_ENCTYPE = 21;
    public static final int ATTR_METHOD = 22;
    public static final int ATTR_WIDTH = 23;
    public static final int ATTR_HEIGHT = 24;
    public static final int ATTR_ALT = 25;
    public static final int ATTR_HSPACE = 26;
    public static final int ATTR_VSPACE = 27;
    public static final int ATTR_LONGDESC = 28;
    public static final int ATTR_LOCALSRC = 29;
    public static final int ATTR_SRC = 30;
    public static final int ATTR_SIZE = 31;
    public static final int ATTR_CHECKED = 32;
    public static final int ATTR_EMPTYOK = 33;
    public static final int ATTR_FORMAT = 34;
    public static final int ATTR_ISTYLE = 35;
    public static final int ATTR_MAXLENGTH = 36;
    public static final int ATTR_NAME = 37;
    public static final int ATTR_VALUE = 38;
    public static final int ATTR_FOR = 39;
    public static final int ATTR_XMLSPACE = 40;
    public static final int ATTR_MULTIPLE = 41;
    public static final int ATTR_SELECTED = 42;
    public static final int ATTR_ABBR = 43;
    public static final int ATTR_AXIS = 44;
    public static final int ATTR_COLSPAN = 45;
    public static final int ATTR_HEADERS = 46;
    public static final int ATTR_ROWSPAN = 47;
    public static final int ATTR_SCOPE = 48;
    public static final int ATTR_VALIGN = 49;
    public static final int ATTR_START = 50;
    public static final int ATTR_MEDIA = 51;
    public static final int ATTR_LABEL = 52;
    public static final int ATTR_SUMMARY = 53;
    public static final int ATTR_CONTENT = 54;
    public static final int ATTR_HTTPEQUIV = 55;
    public static final int ATTR_SCHEME = 56;
    public static final int ATTR_COLS = 57;
    public static final int ATTR_ROWS = 58;
    // Unsupported attributes in XHTML-MP that we DO support
    public static final int ATTR_DIR = 59; //Currently only supported in the html tag
    public static final int ATTR_BORDER = 60;
    // Required by HTML4 tags we support:
    public static final int ATTR_COLOR = 61;
    public static final int ATTR_FACE = 62;
    public static final int ATTR_SHAPE = 63;
    public static final int ATTR_COORDS = 64;
    public static final int ATTR_USEMAP = 65;
    // HTML4 attributes
    public static final int ATTR_LANG = 66;
    public static final int ATTR_CELLSPACING = 67;
    public static final int ATTR_CELLPADDING = 68;
    public static final int ATTR_FRAME = 69;
    public static final int ATTR_RULES = 70;
    public static final int ATTR_DISABLED = 71;
    public static final int ATTR_READONLY = 72;
    public static final int ATTR_ISMAP = 73;
    /// ///////////////////////////////

//HTML-MP colors
    public static final int COLOR_AQUA = 0x00ffff;
    public static final int COLOR_BLACK = 0x000000;
    public static final int COLOR_BLUE = 0x0000ff;
    public static final int COLOR_FUCHSIA = 0xff00ff;
    public static final int COLOR_GRAY = 0x808080;


//////////////////////////////////
// Types                        //
    public static final int COLOR_GREEN = 0x008000;
    public static final int COLOR_LIME = 0x00ff00;
    public static final int COLOR_MAROON = 0x800000;
    public static final int COLOR_NAVY = 0x000080;
    public static final int COLOR_OLIVE = 0x808000;
    public static final int COLOR_PURPLE = 0x800080;
    public static final int COLOR_RED = 0xff0000;
    public static final int COLOR_SILVER = 0xc0c0c0;
    public static final int COLOR_TEAL = 0x008080;
    public static final int COLOR_WHITE = 0xffffff;
    public static final int COLOR_YELLOW = 0xffff00;
    public static final int COLOR_ORANGE = 0xffa500; // Orange is added in CSS 2.1
    /**
     * Defines the tag names, these are specified according to the tag constants numbering.
     */
<span class="nc" id="L273">    static final String[] TAG_NAMES = {</span>
            &quot;body&quot;, &quot;head&quot;, &quot;html&quot;, &quot;title&quot;
            , &quot;abbr&quot;, &quot;acronym&quot;, &quot;address&quot;, &quot;blockquote&quot;, &quot;br&quot;, &quot;cite&quot;, &quot;code&quot;, &quot;dfn&quot;, &quot;div&quot;, &quot;em&quot;, &quot;h1&quot;, &quot;h2&quot;, &quot;h3&quot;, &quot;h4&quot;, &quot;h5&quot;, &quot;h6&quot;, &quot;kbd&quot;, &quot;p&quot;, &quot;pre&quot;, &quot;q&quot;, &quot;samp&quot;, &quot;span&quot;, &quot;strong&quot;, &quot;var&quot;
            , &quot;a&quot;
            , &quot;dl&quot;, &quot;dt&quot;, &quot;dd&quot;, &quot;ol&quot;, &quot;ul&quot;, &quot;li&quot;
            , &quot;form&quot;, &quot;input&quot;, &quot;label&quot;, &quot;select&quot;, &quot;option&quot;, &quot;textarea&quot;
            , &quot;caption&quot;, &quot;table&quot;, &quot;td&quot;, &quot;th&quot;, &quot;tr&quot;
            , &quot;img&quot;
            , &quot;object&quot;, &quot;param&quot;
            , &quot;meta&quot;
            , &quot;link&quot;
            , &quot;base&quot;
            , &quot;hr&quot;, &quot;optgroup&quot;, &quot;style&quot;, &quot;b&quot;, &quot;i&quot;, &quot;big&quot;, &quot;small&quot;, &quot;fieldset&quot;
            //html4 tags
            , &quot;u&quot;, &quot;font&quot;, &quot;del&quot;, &quot;ins&quot;, &quot;tt&quot;, &quot;basefont&quot;, &quot;menu&quot;, &quot;s&quot;, &quot;strike&quot;, &quot;center&quot;, &quot;dir&quot;, &quot;map&quot;, &quot;area&quot;, &quot;legend&quot;, &quot;sub&quot;, &quot;sup&quot;, &quot;noscript&quot;, &quot;noframes&quot;
            , &quot;thead&quot;, &quot;tbody&quot;, &quot;tfoot&quot;, &quot;button&quot;
            , &quot;text&quot;
    };
    /**
     * Defines the allowed attribute names, these are specified according to the ATTR_* constants numbering.
     */
<span class="nc" id="L294">    static final String[] ATTRIBUTE_NAMES = {</span>
            &quot;class&quot;, &quot;id&quot;, &quot;style&quot;, &quot;title&quot;, &quot;xmlns&quot;, &quot;xml:lang&quot;, &quot;align&quot;, &quot;bgcolor&quot;, &quot;link&quot;, &quot;text&quot;, &quot;version&quot;, &quot;cite&quot;,
            &quot;accesskey&quot;, &quot;charset&quot;, &quot;href&quot;, &quot;hreflang&quot;, &quot;rel&quot;, &quot;rev&quot;, &quot;tabindex&quot;, &quot;type&quot;, &quot;action&quot;, &quot;enctype&quot;, &quot;method&quot;,
            &quot;width&quot;, &quot;height&quot;, &quot;alt&quot;, &quot;hspace&quot;, &quot;vspace&quot;, &quot;longdesc&quot;, &quot;localsrc&quot;, &quot;src&quot;, &quot;size&quot;, &quot;checked&quot;, &quot;emptyok&quot;,
            &quot;format&quot;, &quot;istyle&quot;, &quot;maxlength&quot;, &quot;name&quot;, &quot;value&quot;, &quot;for&quot;, &quot;xml:space&quot;, &quot;multiple&quot;, &quot;selected&quot;, &quot;abbr&quot;, &quot;axis&quot;,
            &quot;colspan&quot;, &quot;headers&quot;, &quot;rowspan&quot;, &quot;scope&quot;, &quot;valign&quot;, &quot;start&quot;, &quot;media&quot;, &quot;label&quot;, &quot;summary&quot;, &quot;content&quot;, &quot;http-equiv&quot;, &quot;scheme&quot;,
            &quot;cols&quot;, &quot;rows&quot;, &quot;dir&quot;, &quot;border&quot;,
            &quot;color&quot;, &quot;face&quot;, &quot;shape&quot;, &quot;coords&quot;, &quot;usemap&quot;,
            &quot;lang&quot;, &quot;cellspacing&quot;, &quot;cellpadding&quot;, &quot;frame&quot;, &quot;rules&quot;,
            &quot;disabled&quot;, &quot;readonly&quot;, &quot;ismap&quot;
    };
    /// ///////////////////////////////

// These are the possible types for an attribute. Types define what values are acceptable to the attribute.
    static final int TYPE_NUMBER = 0;
    static final int TYPE_PIXELS_OR_PERCENTAGE = 1;
    static final int TYPE_COLOR = 2;
    static final int TYPE_ALIGN = 3; //note: there are different types of align - TD allows only left,center,right DIV allows also justify, CAPTION allows top,bottom,left,right - however we don't get to that resolution
    static final int TYPE_CHAR = 4;
    static final int TYPE_URL = 5;
    static final int TYPE_CDATA = 6;
    static final int TYPE_NMTOKENS = 7;
    static final int TYPE_ID = 8;
    static final int TYPE_XMLNS = 9;
    static final int TYPE_LANG_CODE = 10; // ((?i)[A-Z]{1,8}(-[A-Z]{1,8})*)?
    static final int TYPE_VERSION = 11;
    static final int TYPE_HTTP_METHOD = 12; // get / post
    static final int TYPE_BOOLEAN = 13;
    static final int TYPE_CHECKED = 14;
    static final int TYPE_IDREF = 15;
    static final int TYPE_PRESERVE = 16;
    static final int TYPE_MULTIPLE = 17;
    static final int TYPE_SELECTED = 18;
    static final int TYPE_IDREFS = 19;
    static final int TYPE_SCOPE = 20; // row / col
    static final int TYPE_VALIGN = 21; // top/middle/bottom


//////////////////////////////////
// Colors                       //
    static final int TYPE_NMTOKEN = 22; // top/middle/bottom
    static final int TYPE_DIRECTION = 23; // ltr/rtl
    static final int TYPE_CSS_LENGTH = 24; // values with CSS suffixes (px/em/ex etc.)
    static final int TYPE_CSS_LENGTH_OR_PERCENTAGE = 25; // values with CSS suffixes (px/em/ex etc.) or percentages
    static final int TYPE_CSS_URL = 26;
    static final int TYPE_CSS_LENGTH_OR_PERCENTAGE_OR_MULTIPLIER = 27; // values with CSS suffixes (px/em/ex etc.) or percentages or a number without unit that represents multiply by (i.e. 1 is 100% of the font size, 2 is 200% and so on)
    /**
     * The allowed values for the 'frame' attribute in the 'table' tag
     * (This was not placed in the ALLOWED_STRINGS in order not to add more data types, since it is very specific for this attribute)
     */
<span class="nc" id="L344">    static final String[] ALLOWED_TABLE_FRAME_STRINGS =</span>
            {&quot;void&quot;, &quot;above&quot;, &quot;below&quot;, &quot;hsides&quot;, &quot;vsides&quot;, &quot;lhs&quot;, &quot;rhs&quot;, &quot;box&quot;, &quot;border&quot;};
    /**
     * The values each string of ALLOWED_TABLE_FRAME_STRINGS represents
     */
<span class="nc" id="L349">    static final int[][] ALLOWED_TABLE_FRAME_VALS =</span>
            {
                    {}, // void
                    {Component.TOP}, // above
                    {Component.BOTTOM}, //below
                    {Component.TOP, Component.BOTTOM}, //hsides
                    {Component.LEFT, Component.RIGHT}, //vsides
                    {Component.LEFT}, //lhs
                    {Component.RIGHT}, // rhs
                    {Component.LEFT, Component.RIGHT, Component.TOP, Component.BOTTOM}, //box
                    {Component.LEFT, Component.RIGHT, Component.TOP, Component.BOTTOM}, //border
            };
    /**
     * The allowed values for the 'rules' attribute in the 'table' tag
     * (This was not placed in the ALLOWED_STRINGS in order not to add more data types, since it is very specific for this attribute)
     */
<span class="nc" id="L365">    static final String[] ALLOWED_TABLE_RULES_STRINGS =</span>
            {&quot;none&quot;, &quot;rows&quot;, &quot;cols&quot;, &quot;all&quot;, &quot;groups&quot;};
    /**
     * Defines the allowed color string that are acceptable as a value to color attributes in HTML-MP1
     */
<span class="nc" id="L370">    static final String[] COLOR_STRINGS = {</span>
            &quot;aqua&quot;, &quot;black&quot;, &quot;blue&quot;, &quot;fuchsia&quot;, &quot;gray&quot;, &quot;green&quot;, &quot;lime&quot;, &quot;maroon&quot;,
            &quot;navy&quot;, &quot;olive&quot;, &quot;purple&quot;, &quot;red&quot;, &quot;silver&quot;, &quot;teal&quot;, &quot;white&quot;, &quot;yellow&quot;,
            &quot;orange&quot;, &quot;grey&quot;
    };
    /**
     * Assigns a color constant to each of the colors defined in COLOR_STRINGS
     */
<span class="nc" id="L378">    static final int[] COLOR_VALS = {</span>
            COLOR_AQUA, COLOR_BLACK, COLOR_BLUE, COLOR_FUCHSIA, COLOR_GRAY, COLOR_GREEN, COLOR_LIME, COLOR_MAROON,
            COLOR_NAVY, COLOR_OLIVE, COLOR_PURPLE, COLOR_RED, COLOR_SILVER, COLOR_TEAL, COLOR_WHITE, COLOR_YELLOW,
            COLOR_ORANGE, COLOR_GRAY
    };
    /**
     * Defines additional allowed color string that are acceptable as a value to color attributes in HTML4
     */
<span class="nc" id="L386">    static final String[] MORE_COLOR_STRINGS = {</span>
            &quot;AliceBlue&quot;, &quot;AntiqueWhite&quot;, &quot;Aqua&quot;, &quot;Aquamarine&quot;, &quot;Azure&quot;, &quot;Beige&quot;, &quot;Bisque&quot;, &quot;Black&quot;, &quot;BlanchedAlmond&quot;, &quot;Blue&quot;, &quot;BlueViolet&quot;, &quot;Brown&quot;, &quot;BurlyWood&quot;,
            &quot;CadetBlue&quot;, &quot;Chartreuse&quot;, &quot;Chocolate&quot;, &quot;Coral&quot;, &quot;CornflowerBlue&quot;, &quot;Cornsilk&quot;, &quot;Crimson&quot;, &quot;Cyan&quot;, &quot;DarkBlue&quot;, &quot;DarkCyan&quot;, &quot;DarkGoldenRod&quot;, &quot;DarkGray&quot;,
            &quot;DarkGrey&quot;, &quot;DarkGreen&quot;, &quot;DarkKhaki&quot;, &quot;DarkMagenta&quot;, &quot;DarkOliveGreen&quot;, &quot;Darkorange&quot;, &quot;DarkOrchid&quot;, &quot;DarkRed&quot;, &quot;DarkSalmon&quot;, &quot;DarkSeaGreen&quot;,
            &quot;DarkSlateBlue&quot;, &quot;DarkSlateGray&quot;, &quot;DarkSlateGrey&quot;, &quot;DarkTurquoise&quot;, &quot;DarkViolet&quot;, &quot;DeepPink&quot;, &quot;DeepSkyBlue&quot;, &quot;DimGray&quot;, &quot;DimGrey&quot;, &quot;DodgerBlue&quot;,
            &quot;FireBrick&quot;, &quot;FloralWhite&quot;, &quot;ForestGreen&quot;, &quot;Fuchsia&quot;, &quot;Gainsboro&quot;, &quot;GhostWhite&quot;, &quot;Gold&quot;, &quot;GoldenRod&quot;, &quot;Gray&quot;, &quot;Grey&quot;, &quot;Green&quot;, &quot;GreenYellow&quot;, &quot;HoneyDew&quot;,
            &quot;HotPink&quot;, &quot;IndianRed &quot;, &quot;Indigo &quot;, &quot;Ivory&quot;, &quot;Khaki&quot;, &quot;Lavender&quot;, &quot;LavenderBlush&quot;, &quot;LawnGreen&quot;, &quot;LemonChiffon&quot;, &quot;LightBlue&quot;, &quot;LightCoral&quot;, &quot;LightCyan&quot;,
            &quot;LightGoldenRodYellow&quot;, &quot;LightGray&quot;, &quot;LightGrey&quot;, &quot;LightGreen&quot;, &quot;LightPink&quot;, &quot;LightSalmon&quot;, &quot;LightSeaGreen&quot;, &quot;LightSkyBlue&quot;, &quot;LightSlateGray&quot;,
            &quot;LightSlateGrey&quot;, &quot;LightSteelBlue&quot;, &quot;LightYellow&quot;, &quot;Lime&quot;, &quot;LimeGreen&quot;, &quot;Linen&quot;, &quot;Magenta&quot;, &quot;Maroon&quot;, &quot;MediumAquaMarine&quot;, &quot;MediumBlue&quot;, &quot;MediumOrchid&quot;,
            &quot;MediumPurple&quot;, &quot;MediumSeaGreen&quot;, &quot;MediumSlateBlue&quot;, &quot;MediumSpringGreen&quot;, &quot;MediumTurquoise&quot;, &quot;MediumVioletRed&quot;, &quot;MidnightBlue&quot;, &quot;MintCream&quot;,
            &quot;MistyRose&quot;, &quot;Moccasin&quot;, &quot;NavajoWhite&quot;, &quot;Navy&quot;, &quot;OldLace&quot;, &quot;Olive&quot;, &quot;OliveDrab&quot;, &quot;Orange&quot;, &quot;OrangeRed&quot;, &quot;Orchid&quot;, &quot;PaleGoldenRod&quot;, &quot;PaleGreen&quot;,
            &quot;PaleTurquoise&quot;, &quot;PaleVioletRed&quot;, &quot;PapayaWhip&quot;, &quot;PeachPuff&quot;, &quot;Peru&quot;, &quot;Pink&quot;, &quot;Plum&quot;, &quot;PowderBlue&quot;, &quot;Purple&quot;, &quot;Red&quot;, &quot;RosyBrown&quot;, &quot;RoyalBlue&quot;,
            &quot;SaddleBrown&quot;, &quot;Salmon&quot;, &quot;SandyBrown&quot;, &quot;SeaGreen&quot;, &quot;SeaShell&quot;, &quot;Sienna&quot;, &quot;Silver&quot;, &quot;SkyBlue&quot;, &quot;SlateBlue&quot;, &quot;SlateGray&quot;, &quot;SlateGrey&quot;, &quot;Snow&quot;, &quot;SpringGreen&quot;,
            &quot;SteelBlue&quot;, &quot;Tan&quot;, &quot;Teal&quot;, &quot;Thistle&quot;, &quot;Tomato&quot;, &quot;Turquoise&quot;, &quot;Violet&quot;, &quot;Wheat&quot;, &quot;White&quot;, &quot;WhiteSmoke&quot;, &quot;Yellow&quot;, &quot;YellowGreen&quot;
    };
    /**
     * Assigns a color constant to each of the colors defined in MORE_COLOR_STRINGS
     */
<span class="nc" id="L404">    static final int[] MORE_COLOR_VALS = {</span>
            0xF0F8FF, 0xFAEBD7, 0x00FFFF, 0x7FFFD4, 0xF0FFFF, 0xF5F5DC, 0xFFE4C4, 0x000000, 0xFFEBCD, 0x0000FF, 0x8A2BE2, 0xA52A2A, 0xDEB887, 0x5F9EA0, 0x7FFF00, 0xD2691E,
            0xFF7F50, 0x6495ED, 0xFFF8DC, 0xDC143C, 0x00FFFF, 0x00008B, 0x008B8B, 0xB8860B, 0xA9A9A9, 0xA9A9A9, 0x006400, 0xBDB76B, 0x8B008B, 0x556B2F, 0xFF8C00, 0x9932CC,
            0x8B0000, 0xE9967A, 0x8FBC8F, 0x483D8B, 0x2F4F4F, 0x2F4F4F, 0x00CED1, 0x9400D3, 0xFF1493, 0x00BFFF, 0x696969, 0x696969, 0x1E90FF, 0xB22222, 0xFFFAF0, 0x228B22,
            0xFF00FF, 0xDCDCDC, 0xF8F8FF, 0xFFD700, 0xDAA520, 0x808080, 0x808080, 0x008000, 0xADFF2F, 0xF0FFF0, 0xFF69B4, 0xCD5C5C, 0x4B0082, 0xFFFFF0, 0xF0E68C, 0xE6E6FA,
            0xFFF0F5, 0x7CFC00, 0xFFFACD, 0xADD8E6, 0xF08080, 0xE0FFFF, 0xFAFAD2, 0xD3D3D3, 0xD3D3D3, 0x90EE90, 0xFFB6C1, 0xFFA07A, 0x20B2AA, 0x87CEFA, 0x778899, 0x778899,
            0xB0C4DE, 0xFFFFE0, 0x00FF00, 0x32CD32, 0xFAF0E6, 0xFF00FF, 0x800000, 0x66CDAA, 0x0000CD, 0xBA55D3, 0x9370D8, 0x3CB371, 0x7B68EE, 0x00FA9A, 0x48D1CC, 0xC71585,
            0x191970, 0xF5FFFA, 0xFFE4E1, 0xFFE4B5, 0xFFDEAD, 0x000080, 0xFDF5E6, 0x808000, 0x6B8E23, 0xFFA500, 0xFF4500, 0xDA70D6, 0xEEE8AA, 0x98FB98, 0xAFEEEE, 0xD87093,
            0xFFEFD5, 0xFFDAB9, 0xCD853F, 0xFFC0CB, 0xDDA0DD, 0xB0E0E6, 0x800080, 0xFF0000, 0xBC8F8F, 0x4169E1, 0x8B4513, 0xFA8072, 0xF4A460, 0x2E8B57, 0xFFF5EE, 0xA0522D,
            0xC0C0C0, 0x87CEEB, 0x6A5ACD, 0x708090, 0x708090, 0xFFFAFA, 0x00FF7F, 0x4682B4, 0xD2B48C, 0x008080, 0xD8BFD8, 0xFF6347, 0x40E0D0, 0xEE82EE, 0xF5DEB3, 0xFFFFFF,
            0xF5F5F5, 0xFFFF00, 0x9ACD32
    };
    /**
     * This array defines the 6 common attributes that each tag has
     */
<span class="nc" id="L419">    private static final int[] COMMON_ATTRIBUTES = {ATTR_CLASS, ATTR_ID, ATTR_STYLE, ATTR_TITLE, ATTR_XMLNS, ATTR_XMLLANG, ATTR_LANG};</span>
    /**
     * This array defines the allowed attributes for each tag, according to the XHTML-MP 1.0 spec
     */
<span class="nc" id="L423">    private static final int[][] TAG_ATTRIBUTES = {</span>
            //Structure Module
            {
                    ATTR_BGCOLOR, // #rrggbb | colors  // Deprecated but supported
                    ATTR_LINK, // #rrggbb | colors     // Deprecated but supported
                    ATTR_TEXT //#rrggbb | colors       // Deprecated but supported
            }, // BODY = 0;
            {}, // HEAD = 1;
            {
                    //ATTR_VERSION, // = //WAPFORUM//DTD XHTML Mobile 1.0//EN // We don't use the version attribute
                    ATTR_DIR

            }, // HTML = 2;
            {}, // TITLE = 3;

            //Text Module -
            {}, // ABBR = 4;
            {}, // ACRONYM = 5;
            {}, // ADDRESS = 6;
            {
                    //ATTR_CITE // URL // Not supported by any of the major browsers
            }, // BLOCKQUOTE = 7;
            {}, // BR = 8;
            {}, // CITE = 9;
            {}, // CODE = 10;
            {}, // DFN = 11;
            {
                    ATTR_ALIGN // top/bottom/left/right
            }, // DIV = 12;
            {}, // EM = 13;
            {
                    ATTR_ALIGN // top/bottom/left/right
            }, // H1 = 14;
            {
                    ATTR_ALIGN // top/bottom/left/right
            }, // H2 = 15;
            {
                    ATTR_ALIGN // top/bottom/left/right
            }, // H3 = 16;
            {
                    ATTR_ALIGN // top/bottom/left/right
            }, // H4 = 17;
            {
                    ATTR_ALIGN // top/bottom/left/right
            }, // H5 = 18;
            {
                    ATTR_ALIGN // top/bottom/left/right
            }, // H6 = 19;
            {}, // KBD = 20;
            {
                    ATTR_ALIGN // left | center | right | justify
            }, // P = 21;
            {
                    //ATTR_XMLSPACE, // preserve // We don't use this attribute
            }, // PRE = 22;
            {
                    //ATTR_CITE // URL // The cite attribute is not supported by any of the major browsers.
            }, // Q = 23;
            {}, // SAMP = 24;
            {}, // SPAN = 25;
            {}, // STRONG = 26;
            {}, // VAR = 27;

            //Hypertext Module -
            {
                    ATTR_ACCESSKEY, // character
                    //ATTR_CHARSET, // cdata // The charset attribute is not supported in any of the major browsers.
                    ATTR_HREF, // URL
                    //ATTR_HREFLANG, // ((?i)[A-Z]{1,8}(-[A-Z]{1,8})*)? // The hreflang attribute is not supported in any of the major browsers.
                    //ATTR_REL, // nmtokens  // Not used by browsers
                    //ATTR_REV, // nmtokens  // Not used by browsers
                    //ATTR_TABINDEX, // number
                    //ATTR_TYPE, // cdata // Should specify the MIME type of the document, but we don't use it anyway
                    ATTR_NAME // Note: Name on the a tag (anchor) is not supported on XHTML-MP 1.0, but we support it
            }, // A = 28;

            //List Module -
            {}, // DL = 29;
            {}, // DT = 30;
            {}, // DD = 31;
            {
                    ATTR_START, // number  // Deprecated but supported
                    ATTR_TYPE // cdata     // Deprecated but supported
            }, // OL = 32;
            {}, // UL = 33;
            {
                    ATTR_TYPE, // cdata    // Deprecated but supported
                    ATTR_VALUE // number   // Deprecated but supported
            }, // LI = 34;
            //Basic Forms Module -
            {
                    ATTR_ACTION, // URL
                    ATTR_ENCTYPE, // cdata
                    ATTR_METHOD, // get | post

            }, // FORM = 35;
            {
                    ATTR_ACCESSKEY, // character
                    ATTR_CHECKED, // checked
                    ATTR_EMPTYOK, // true | false    // This attribute was said to be supported on XHTML-MP1 on various sources, but verified as not
                    ATTR_FORMAT, // cdata            // Deprecated but still supported
                    //ATTR_ISTYLE, // cdata            // This attribute was said to be supported on XHTML-MP1 on various sources, but verified as not
                    //ATTR_LOCALSRC, // cdata          // This attribute was said to be supported on XHTML-MP1 on various sources, but verified as not
                    ATTR_MAXLENGTH, // number
                    ATTR_NAME, // cdata
                    ATTR_SIZE, // cdata
                    ATTR_SRC, // URL
                    ATTR_TABINDEX, // number
                    ATTR_TYPE, // text | password | checkbox | radio | submit | reset | hidden
                    ATTR_VALUE, // cdata
                    ATTR_DISABLED,
                    ATTR_READONLY
            }, // INPUT = 36;
            {
                    ATTR_ACCESSKEY,
                    ATTR_FOR
            }, // LABEL = 37;
            {
                    ATTR_MULTIPLE, // multiple
                    ATTR_NAME, // cdata
                    ATTR_SIZE, // number
                    ATTR_TABINDEX, // number
                    ATTR_DISABLED,
            }, // SELECT = 38;
            {
                    ATTR_SELECTED, // selected
                    ATTR_VALUE, // cdata
                    ATTR_DISABLED,
            }, // OPTION = 39;
            {
                    ATTR_ACCESSKEY, // character
                    ATTR_COLS, // number
                    ATTR_NAME, // cdata
                    ATTR_ROWS, // number
                    ATTR_TABINDEX, // number
                    ATTR_DISABLED,
                    ATTR_READONLY
            }, // TEXTAREA = 40;

            //Basic Tables Module -
            {
                    ATTR_ALIGN // top/bottom/left/right
            }, // CAPTION = 41;
            {
                    //ATTR_SUMMARY, // cdata  // The summary attribute makes no visual difference in ordinary web browsers.
                    ATTR_BORDER,
                    ATTR_CELLSPACING,
                    ATTR_CELLPADDING,
                    ATTR_FRAME,
                    ATTR_RULES,
            }, // TABLE = 42;
            {
                    //ATTR_ABBR, // cdata  // The abbr attribute makes no visual difference in ordinary web browsers.
                    ATTR_ALIGN, // left | center | right
                    //ATTR_AXIS, // cdata  // The axis attribute is not supported by any of the major browsers
                    ATTR_COLSPAN, // number
                    //ATTR_HEADERS, // IDREFS // The headers attribute makes no visual difference in ordinary web browsers.
                    ATTR_ROWSPAN, // number
                    //ATTR_SCOPE, // row | col // // The scope attribute makes no visual difference in ordinary web browsers.
                    ATTR_VALIGN, // top | middle | bottom
                    ATTR_WIDTH,  // number or % - deprecated but still supported
                    ATTR_HEIGHT, // number or % - deprecated but still supported
            }, // TD = 43;
            {
                    //ATTR_ABBR, // cdata  // The abbr attribute makes no visual difference in ordinary web browsers.
                    ATTR_ALIGN, // left | center | right
                    //ATTR_AXIS, // cdata  // The axis attribute is not supported by any of the major browsers
                    ATTR_COLSPAN, // number
                    //ATTR_HEADERS, // IDREFS // The headers attribute makes no visual difference in ordinary web browsers.
                    ATTR_ROWSPAN, // number
                    //ATTR_SCOPE, // row | col // // The scope attribute makes no visual difference in ordinary web browsers.
                    ATTR_VALIGN, // top | middle | bottom
                    ATTR_WIDTH,  // number or % - deprecated but still supported
                    ATTR_HEIGHT, // number or % - deprecated but still supported

            }, // TH = 44;
            {
                    ATTR_ALIGN, // = left | center | right
                    ATTR_VALIGN // top | middle | bottom
            }, // TR = 45;

            //Image Module -
            {
                    ATTR_ALIGN, // top | middle | bottom | left | right
                    ATTR_ALT, // cdata
                    ATTR_HEIGHT, // number[%]
                    ATTR_HSPACE, // number
                    //ATTR_LOCALSRC, // cdata          // This attribute was said to be supported on XHTML-MP1 on various sources, but verified as not
                    //ATTR_LONGDESC, // URL //The longdesc attribute is not supported by any of the major browsers.
                    ATTR_SRC, // URL
                    ATTR_VSPACE, // number
                    ATTR_WIDTH, // number[%]
                    ATTR_USEMAP, // for HTML4
                    ATTR_BORDER, // for HTML4
                    ATTR_ISMAP // for HTML4
            }, // IMG = 46;

            //Object Module -
            {
                    /*    ATTR_ARCHIVE, // &amp;URLs
                        ATTR_CLASSID, // URL
                        ATTR_CODEBASE, // URL
                        ATTR_CODETYPE, // cdata
                        ATTR_DATA, // URL
                        ATTR_DECLARE, // declare
                        ATTR_HEIGHT, // number[%]
                        ATTR_NAME, // cdata
                        ATTR_STANDBY, // cdata
                        ATTR_TABINDEX, // number
                        ATTR_TYPE, // cdata
                        ATTR_WIDTH, // number[%] */
            }, // OBJECT = 47;
            {
                    /* ATTR_NAME, //  cdata
                     ATTR_TYPE, //  cdata
                     ATTR_VALUE, //  cdata
                     ATTR_VALUETYPE // data | ref | object */

            }, // PARAM = 48;

            //Metainformation Module
            {
                    ATTR_CONTENT, // cdata
                    ATTR_HTTPEQUIV, // nmtoken
                    ATTR_NAME, // nmtoken  // We do not make any use of this attribute
                    //ATTR_SCHEME, // cdata  // We do not make any use of this attribute
            }, // META = 49;

            //Link Module -
            {
                    //ATTR_CHARSET, // cdata  //The charset attribute is not supported by any of the major browsers.
                    ATTR_HREF, // URL
                    //ATTR_HREFLANG, // ((?i)[A-Z]{1,8}(-[A-Z]{1,8})*)? // The hreflang attribute is not supported in any of the major browsers.
                    ATTR_MEDIA, // cdata
                    ATTR_REL, // nmtokens
                    //ATTR_REV, // nmtokens // The rev attribute is not supported in any of the major browsers.
                    ATTR_TYPE, // cdata
            }, // LINK = 50;

            //Base Module -
            {
                    ATTR_HREF // URL
            }, // BASE = 51;

            //XHTML-MP
            {
                    ATTR_ALIGN, // left | center | right
                    ATTR_SIZE, // number     // Deprecated but still supported
                    ATTR_WIDTH, // number[%] // Deprecated but still supported

            }, // HR = 52;
            {
                    ATTR_LABEL
            }, // OPTGROUP = 53
            {
                    ATTR_MEDIA, // cdata
                    ATTR_TYPE, // cdata
                    //ATTR_XMLSPACE, // preserve  // We don't use this attribute

            }, // STYLE = 54
            {}, //B = 55;
            {}, //I = 56;
            {}, //BIG = 57;
            {}, //SMALL = 58;
            {}, //FIELDSET = 59;
            {}, //U = 60; // Underline
            {
                    ATTR_COLOR,
                    ATTR_SIZE,
                    ATTR_FACE,
            }, //FONT = 61;
            {}, //DEL = 62;
            {}, //INS = 63;
            {}, //TT = 64;
            {
                    ATTR_COLOR,
                    ATTR_SIZE,
                    ATTR_FACE,
            }, //BASEFONT = 65;
            {}, //MENU = 66; // Same as UL
            {}, //S = 67; // Strike through
            {}, //STRIKE = 68; // Strike through
            {}, //CENTER = 69; // shorthand for DIV align=center
            {}, //DIR = 70;// Same as UL
            {
                    ATTR_NAME
            }, //MAP = 71;
            {
                    ATTR_SHAPE,
                    ATTR_COORDS,
                    ATTR_HREF,
                    ATTR_ALT
            }, //AREA = 72;
            {}, //LEGEND = 73;
            {}, //SUB = 74;
            {}, //SUP = 75;
            {}, //NOSCRIPT = 76;
            {}, //NOFRAMES = 77;
            {
                    ATTR_ALIGN,
                    ATTR_VALIGN
            }, //TAG_THEAD = 78;
            {
                    ATTR_ALIGN,
                    ATTR_VALIGN
            }, //TAG_TBODY = 79;
            {
                    ATTR_ALIGN,
                    ATTR_VALIGN
            }, //TAG_TFOOT = 80;
            {
                    ATTR_ACCESSKEY, // character
                    ATTR_CHECKED, // checked
                    ATTR_EMPTYOK, // true | false    // This attribute was said to be supported on XHTML-MP1 on various sources, but verified as not
                    ATTR_FORMAT, // cdata            // Deprecated but still supported
                    //ATTR_ISTYLE, // cdata            // This attribute was said to be supported on XHTML-MP1 on various sources, but verified as not
                    //ATTR_LOCALSRC, // cdata          // This attribute was said to be supported on XHTML-MP1 on various sources, but verified as not
                    ATTR_MAXLENGTH, // number
                    ATTR_NAME, // cdata
                    ATTR_SIZE, // cdata
                    ATTR_SRC, // URL
                    ATTR_TABINDEX, // number
                    ATTR_TYPE, // text | password | checkbox | radio | submit | reset | hidden
                    ATTR_VALUE, // cdata
                    ATTR_DISABLED,
                    ATTR_READONLY
            },//BUTTON = 81;
            {}, //TEXT = 82;

    };
    /**
     * This array assigns a type to each of the attributes.
     */
<span class="nc" id="L756">    private static final int[] ATTRIBUTE_TYPES = {</span>
            TYPE_NMTOKENS, //&quot;class&quot;,
            TYPE_ID, //&quot;id&quot;,
            TYPE_CDATA, //&quot;style&quot;,
            TYPE_CDATA, //&quot;title&quot;,
            TYPE_XMLNS, //&quot;xmlns&quot;,
            TYPE_LANG_CODE, //&quot;xml:lang&quot;,
            TYPE_ALIGN, //&quot;align&quot;,
            TYPE_COLOR, //&quot;bgcolor&quot;,
            TYPE_COLOR, //&quot;link&quot;,
            TYPE_COLOR, //&quot;text&quot;,
            TYPE_VERSION, //&quot;version&quot;,
            TYPE_URL, //&quot;cite&quot;,
            TYPE_CHAR, //&quot;accesskey&quot;,
            TYPE_CDATA, //&quot;charset&quot;,
            TYPE_URL, //&quot;href&quot;,
            TYPE_LANG_CODE, //&quot;hreflang&quot;,
            TYPE_NMTOKENS, //&quot;rel&quot;,
            TYPE_NMTOKENS, //&quot;rev&quot;,
            TYPE_NUMBER, //&quot;tabindex&quot;,
            TYPE_CDATA, //&quot;type&quot;,
            TYPE_URL, //&quot;action&quot;,
            TYPE_CDATA, //&quot;enctype&quot;,
            TYPE_HTTP_METHOD, //&quot;method&quot;,
            TYPE_PIXELS_OR_PERCENTAGE, //&quot;width&quot;,
            TYPE_PIXELS_OR_PERCENTAGE, //&quot;height&quot;,
            TYPE_CDATA, //&quot;alt&quot;,
            TYPE_NUMBER, //&quot;hspace&quot;,
            TYPE_NUMBER, //&quot;vspace&quot;,
            TYPE_URL, //&quot;longdesc&quot;,
            TYPE_CDATA, //&quot;localsrc&quot;,
            TYPE_URL, //&quot;src&quot;,
            TYPE_CDATA, //&quot;size&quot;,
            TYPE_CHECKED, //&quot;checked&quot;,
            TYPE_BOOLEAN, //&quot;emptyok&quot;,
            TYPE_CDATA, //&quot;format&quot;,
            TYPE_CDATA, //&quot;istyle&quot;,
            TYPE_NUMBER, //&quot;maxlength&quot;,
            TYPE_CDATA, //&quot;name&quot;,
            TYPE_CDATA, //&quot;value&quot;,
            TYPE_IDREF, //&quot;for&quot;,
            TYPE_PRESERVE, //&quot;xml:space&quot;,
            TYPE_MULTIPLE, //&quot;multiple&quot;,
            TYPE_SELECTED, //&quot;selected&quot;,
            TYPE_CDATA, //&quot;abbr&quot;,
            TYPE_CDATA, //&quot;axis&quot;,
            TYPE_NUMBER, //&quot;colspan&quot;,
            TYPE_IDREFS, //&quot;headers&quot;,
            TYPE_NUMBER, //&quot;rowspan&quot;,
            TYPE_SCOPE, //&quot;scope&quot;,
            TYPE_VALIGN, //&quot;valign&quot;,
            TYPE_NUMBER, //&quot;start&quot;,
            TYPE_CDATA, //&quot;media&quot;,
            TYPE_CDATA, //&quot;label&quot;,
            TYPE_CDATA, //&quot;summary&quot;,
            TYPE_CDATA, //&quot;content&quot;,
            TYPE_NMTOKEN, //&quot;http-equiv&quot;,
            TYPE_CDATA, //&quot;scheme&quot;,
            TYPE_NUMBER, //&quot;cols&quot;,
            TYPE_NUMBER, //&quot;rows&quot;
            TYPE_DIRECTION, //&quot;dir&quot;
            TYPE_NUMBER, // &quot;border&quot;
            TYPE_COLOR, // &quot;color&quot;
            TYPE_NMTOKEN, // &quot;face&quot;
            TYPE_NMTOKEN, // &quot;shape&quot;
            TYPE_NMTOKEN, // &quot;coords&quot;
            TYPE_NMTOKEN, // &quot;usemap&quot;
            TYPE_NMTOKEN, // &quot;lang&quot;
            TYPE_NUMBER, // &quot;cellspacing&quot;
            TYPE_NUMBER, // &quot;cellpadding&quot;
            TYPE_NMTOKEN, // &quot;frame&quot;
            TYPE_NMTOKEN, // &quot;rules&quot;
            TYPE_NMTOKEN, //ATTR_DISABLED = 71;
            TYPE_NMTOKEN, //ATTR_READONLY = 72;
            TYPE_NMTOKEN, //ATTR_ISMAP = 73;
    };
    // Additional constants used to define allowed characters for specific types
    private static final int DIGITS = 1;
    private static final int HEX = 2;
    private static final int ABC = 4;
    private static final int LAST_TAG_INDEX = HTMLComponent.PROCESS_HTML_MP1_ONLY ? TAG_FIELDSET : TAG_BUTTON; // In any case we exclude TAG_TEXT, which is given only on text element creation
    /**
     * Some types accept only a specific set of strings. For these this array defines the allowed strings.
     * If the value is null it means that the type has another rule set (for example numbers only).
     * This is checked against in the DOM building process.
     */
<span class="nc" id="L842">    private static final String[][] ALLOWED_STRINGS = {</span>
            null, // TYPE_NUMBER = 0;
            null, // TYPE_PIXELS_OR_PERCENTAGE = 1;
            null, // TYPE_COLOR = 2;
            {&quot;left&quot;, &quot;right&quot;, &quot;top&quot;, &quot;bottom&quot;, &quot;center&quot;, &quot;middle&quot;, &quot;justify&quot;}, // TYPE_ALIGN = 3;
            null, // TYPE_CHAR = 4;
            null, // TYPE_URL = 5;
            null, // TYPE_CDATA = 6;
            null, // TYPE_NMTOKENS = 7;
            null, // TYPE_ID = 8;
            null, // TYPE_XMLNS = 9;
            null, // TYPE_LANG_CODE = 10; // ((?i)[A-Z]{1,8}(-[A-Z]{1,8})*)?
            null, // TYPE_VERSION = 11;
            {&quot;get&quot;, &quot;post&quot;}, // TYPE_HTTP_METHOD = 12; // get / post
            {&quot;true&quot;, &quot;false&quot;}, // TYPE_BOOLEAN = 13;
            {&quot;checked&quot;}, // TYPE_CHECKED = 14;
            null, // TYPE_IDREF = 15;
            {&quot;default&quot;, &quot;preserve&quot;}, // TYPE_PRESERVE = 16;
            {&quot;multiple&quot;}, // TYPE_MULTIPLE = 17;
            {&quot;selected&quot;}, // TYPE_SELECTED = 18;
            null, // TYPE_IDREFS = 19;
            {&quot;row&quot;, &quot;col&quot;}, // TYPE_SCOPE = 20; // row / col
            {&quot;top&quot;, &quot;bottom&quot;, &quot;middle&quot;}, // TYPE_VALIGN = 21; // top/middle/bottom
            null, // TYPE_NMTOKEN = 22; // top/middle/bottom
            {&quot;ltr&quot;, &quot;rtl&quot;}, // TYPE_DIRECTION
    };
    /**
     * The tag ID. Upon construction of tag with a name, a lookup is performed to assign it an ID accordign to the TAG_NAMES array.
     * THe ID is used to find what are the allowed attributes, and also prevents the need for further string parsing later on.
     */
<span class="nc" id="L872">    private int id = TAG_UNSUPPORTED;</span>


// Member variables:
    /**
     * A vector holding all associate components
     */
    private Vector comps;
    /**
     * If true than the UI components where calculated automatically
     */
<span class="nc" id="L883">    private boolean calculatedUi = false;</span>

    /**
     * Constructs and HTMLElement without specifying a name.
     * This can be used by subclasses that do not require name assigments.
     */
<span class="nc" id="L889">    protected HTMLElement() {</span>
<span class="nc" id="L890">    }</span>


    /**
     * Constructor for HTMLElement. This mostly sets up the element's ID.
     *
     * @param tagName The HTMLElement's name
     */
<span class="nc" id="L898">    public HTMLElement(String tagName) {</span>
<span class="nc" id="L899">        init(tagName);</span>
<span class="nc" id="L900">    }</span>

    /**
     * Constructor for HTMLElement. This mostly sets up the element's ID.
     *
     * @param tagName       The HTMLElement's name, or the text for text elements
     * @param isTextElement true for a text element, false otherwise
     */
<span class="nc" id="L908">    public HTMLElement(String tagName, boolean isTextElement) {</span>
<span class="nc" id="L909">        setTextElement(isTextElement);</span>
<span class="nc bnc" id="L910" title="All 2 branches missed.">        if (isTextElement) {</span>
<span class="nc" id="L911">            setTagName(tagName);</span>
<span class="nc" id="L912">            id = TAG_TEXT;</span>
        } else {
<span class="nc" id="L914">            init(tagName);</span>
        }
<span class="nc" id="L916">    }</span>

    /**
     * Converts a color string into an int value.
     * This method supports color denoted in hex (with a leading #), named colors (from the standard HTML colors) and rgb(x,y,z)
     *
     * @param colorStr     The string representing the color
     * @param defaultColor Default color if color parsing can't be done
     * @return The int value of the parsed color
     */
    static int getColor(String colorStr, int defaultColor) {
<span class="nc bnc" id="L927" title="All 4 branches missed.">        if ((colorStr == null) || (colorStr.equals(&quot;&quot;))) {</span>
<span class="nc" id="L928">            return defaultColor;</span>
        }
<span class="nc bnc" id="L930" title="All 2 branches missed.">        if (colorStr.charAt(0) != '#') {</span>

<span class="nc bnc" id="L932" title="All 2 branches missed.">            if (colorStr.startsWith(&quot;rgb(&quot;)) {</span>
<span class="nc" id="L933">                colorStr = colorStr.substring(4);</span>
<span class="nc" id="L934">                char[] tokens = {',', ',', ')'};</span>
<span class="nc" id="L935">                int weight = 256 * 256;</span>
<span class="nc" id="L936">                int color = 0;</span>
<span class="nc bnc" id="L937" title="All 2 branches missed.">                for (int i = 0; i &lt; 3; i++) {</span>
<span class="nc" id="L938">                    int index = colorStr.indexOf(tokens[i]);</span>
<span class="nc bnc" id="L939" title="All 2 branches missed.">                    if (index == -1) {</span>
<span class="nc" id="L940">                        return defaultColor; // Unparsed color</span>
                    }
<span class="nc" id="L942">                    String channelStr = colorStr.substring(0, index).trim();</span>

<span class="nc" id="L944">                    int channel = HTMLComponent.calcSize(255, channelStr, 0, true);</span>
<span class="nc" id="L945">                    channel = Math.min(channel, 255); // Set to 255 if over 255</span>
<span class="nc" id="L946">                    channel = Math.max(channel, 0); // Set to 0 if negative</span>

<span class="nc" id="L948">                    color += channel * weight;</span>
<span class="nc" id="L949">                    colorStr = colorStr.substring(index + 1);</span>
<span class="nc" id="L950">                    weight /= 256;</span>
                }
<span class="nc" id="L952">                return color;</span>

            } else {
<span class="nc bnc" id="L955" title="All 2 branches missed.">                for (int i = 0; i &lt; COLOR_STRINGS.length; i++) {</span>
<span class="nc bnc" id="L956" title="All 2 branches missed.">                    if (colorStr.equalsIgnoreCase(COLOR_STRINGS[i])) {</span>
<span class="nc" id="L957">                        return COLOR_VALS[i];</span>
                    }
                }
                if (!HTMLComponent.PROCESS_HTML_MP1_ONLY) {
<span class="nc bnc" id="L961" title="All 2 branches missed.">                    for (int i = 0; i &lt; MORE_COLOR_STRINGS.length; i++) {</span>
<span class="nc bnc" id="L962" title="All 2 branches missed.">                        if (colorStr.equalsIgnoreCase(MORE_COLOR_STRINGS[i])) {</span>
<span class="nc" id="L963">                            return MORE_COLOR_VALS[i];</span>
                        }
                    }
                }

            }
        } else {
<span class="nc" id="L970">            colorStr = colorStr.substring(1);</span>
        }

<span class="nc bnc" id="L973" title="All 2 branches missed.">        if (colorStr.length() == 3) { // shortened format rgb - translated to rrggbb</span>
<span class="nc" id="L974">            String newColStr = &quot;&quot;;</span>
<span class="nc bnc" id="L975" title="All 2 branches missed.">            for (int i = 0; i &lt; 3; i++) {</span>
<span class="nc" id="L976">                newColStr += colorStr.charAt(i) + &quot;&quot; + colorStr.charAt(i);</span>
            }
<span class="nc" id="L978">            colorStr = newColStr;</span>
        }

        try {
<span class="nc" id="L982">            int color = Integer.parseInt(colorStr, 16);</span>
<span class="nc" id="L983">            return color;</span>
<span class="nc" id="L984">        } catch (NumberFormatException nfe) {</span>
<span class="nc" id="L985">            return defaultColor;</span>
        }
    }

    private void init(String tagName) {
<span class="nc" id="L990">        int i = 0;</span>
<span class="nc" id="L991">        int tagId = -1;</span>

<span class="nc bnc" id="L993" title="All 4 branches missed.">        while ((tagId == -1) &amp;&amp; (i &lt;= LAST_TAG_INDEX)) {   // -1 to exclude TAG_TEXT, which is given only on text element creation</span>
<span class="nc bnc" id="L994" title="All 2 branches missed.">            if (TAG_NAMES[i].equals(tagName)) {</span>
<span class="nc" id="L995">                tagId = i;</span>
            } else {
<span class="nc" id="L997">                i++;</span>
            }
        }
<span class="nc" id="L1000">        id = tagId;</span>
<span class="nc bnc" id="L1001" title="All 2 branches missed.">        if (id == TAG_UNSUPPORTED) {</span>
<span class="nc" id="L1002">            setTagName(tagName);</span>
        }
<span class="nc" id="L1004">    }</span>

    /**
     * Sets the given component or Vector of components to be associated with this element.
     * This is used internally to apply CSS styling.
     *
     * @param obj The component (or vector of components) representing this HTMLElement
     */
    void setAssociatedComponents(Object obj) {
<span class="nc bnc" id="L1013" title="All 2 branches missed.">        if (obj instanceof Vector) {</span>
<span class="nc" id="L1014">            comps = (Vector) obj;</span>
        } else {
<span class="nc" id="L1016">            comps = new Vector();</span>
<span class="nc" id="L1017">            comps.addElement(obj);</span>
        }
<span class="nc" id="L1019">    }</span>

    /**
     * Clears the associated components object
     */
    void clearAssociatedComponents() {
<span class="nc" id="L1025">        comps = null;</span>
<span class="nc" id="L1026">    }</span>

    /**
     * Adds the given component to be associated with this element.
     * This is used internally to apply CSS styling.
     *
     * @param cmp The component to add
     */
    void addAssociatedComponent(Component cmp) {
<span class="nc bnc" id="L1035" title="All 2 branches missed.">        if (comps == null) {</span>
<span class="nc" id="L1036">            comps = new Vector();</span>
        }
<span class="nc" id="L1038">        comps.addElement(cmp);</span>
<span class="nc" id="L1039">    }</span>

    /**
     * Adds the given component to be associated with this element.
     * This is used internally to apply CSS styling.
     *
     * @param index The index to insert the component to
     * @param cmp   The component to add
     */
    void addAssociatedComponentAt(int index, Component cmp) {
<span class="nc bnc" id="L1049" title="All 2 branches missed.">        if (comps == null) {</span>
<span class="nc" id="L1050">            comps = new Vector();</span>
        }
<span class="nc" id="L1052">        comps.insertElementAt(cmp, index);</span>
<span class="nc" id="L1053">    }</span>


    public void addChild(Element childElement) {
        //if (((HTMLElement)childElement).getId()!=TAG_UNSUPPORTED) {
<span class="nc" id="L1058">        super.addChild(childElement);</span>
        //}

<span class="nc" id="L1061">    }</span>

    /**
     * Returns whether this element supports the common core attributes.
     * These are attributes most HTML tags support, with a few exceptions that are checked here.
     * Note that to be exact the common atributes are divided to 2 groups: core attributes (class,id,title,style) and language attributes (xmlns,xml:lang)
     * The tags checked here all don't support the core attributes but in fact may support the language attributes.
     * Since the language attributes are not implemented anyway, this is not critical.
     * For reference, tags that do not support the language attributes in XHTML-MP1 are: param, hr, base, br
     *
     * @return true if core attributes are supported, false otherwise
     */
    private boolean supportsCoreAttributes() {
<span class="nc bnc" id="L1074" title="All 14 branches missed.">        return ((id != TAG_STYLE) &amp;&amp; (id != TAG_META) &amp;&amp; (id != TAG_HEAD) &amp;&amp; (id != TAG_HTML) &amp;&amp; (id != TAG_TITLE) &amp;&amp; (id != TAG_PARAM) &amp;&amp; (id != TAG_BASE));</span>
    }

    /**
     * Adds the specified attribute and value to this Element if it is supported for the Element and has a valid value.
     *
     * @param attribute The attribute's name
     * @param value     The attribute's value
     * @return a positive error code or -1 if attribute is supported and valid
     */
    public int setAttribute(String attribute, String value) {
<span class="nc bnc" id="L1085" title="All 2 branches missed.">        if (id == TAG_UNSUPPORTED) {</span>
<span class="nc" id="L1086">            return -1; //No error code for this case since tag not supported error is already notified before</span>
        }

<span class="nc" id="L1089">        int attrId = -1;</span>
<span class="nc" id="L1090">        int i = 0;</span>
<span class="nc bnc" id="L1091" title="All 2 branches missed.">        if (supportsCoreAttributes()) {</span>
<span class="nc bnc" id="L1092" title="All 4 branches missed.">            while ((attrId == -1) &amp;&amp; (i &lt; COMMON_ATTRIBUTES.length)) {</span>
<span class="nc bnc" id="L1093" title="All 2 branches missed.">                if (ATTRIBUTE_NAMES[COMMON_ATTRIBUTES[i]].equals(attribute)) {</span>
<span class="nc" id="L1094">                    attrId = COMMON_ATTRIBUTES[i];</span>
                } else {
<span class="nc" id="L1096">                    i++;</span>
                }
            }
        }

<span class="nc" id="L1101">        i = 0;</span>
<span class="nc bnc" id="L1102" title="All 4 branches missed.">        while ((attrId == -1) &amp;&amp; (i &lt; TAG_ATTRIBUTES[id].length)) {</span>
<span class="nc bnc" id="L1103" title="All 2 branches missed.">            if (ATTRIBUTE_NAMES[TAG_ATTRIBUTES[id][i]].equals(attribute)) {</span>
<span class="nc" id="L1104">                attrId = TAG_ATTRIBUTES[id][i];</span>
            } else {
<span class="nc" id="L1106">                i++;</span>
            }
        }

<span class="nc bnc" id="L1110" title="All 2 branches missed.">        if (attrId == -1) {</span>
<span class="nc" id="L1111">            return HTMLCallback.ERROR_ATTRIBUTE_NOT_SUPPORTED;</span>

        } else {
<span class="nc bnc" id="L1114" title="All 2 branches missed.">            if (isValid(ATTRIBUTE_TYPES[attrId], value)) {</span>
<span class="nc" id="L1115">                setAttribute(Integer.valueOf(attrId), value);</span>
            } else {
<span class="nc" id="L1117">                return HTMLCallback.ERROR_ATTIBUTE_VALUE_INVALID;</span>
            }
        }

<span class="nc" id="L1121">        return -1;</span>
    }

    /**
     * Allows setting an attribute with an attribute id
     *
     * @param attrId The attribute Id (One of the ATTR_ constants)
     * @param value  The value to set to the attribute
     */
    public void setAttributeById(int attrId, String value) {
<span class="nc bnc" id="L1131" title="All 4 branches missed.">        if ((attrId &lt; 0) || (attrId &gt;= ATTRIBUTE_NAMES.length)) {</span>
<span class="nc" id="L1132">            throw new IllegalArgumentException(&quot;Attribute Id must be in the range of 0-&quot; + (ATTRIBUTE_NAMES.length - 1));</span>
        }
<span class="nc bnc" id="L1134" title="All 2 branches missed.">        if (isValid(ATTRIBUTE_TYPES[attrId], value)) {</span>
<span class="nc" id="L1135">            setAttribute(Integer.valueOf(attrId), value);</span>
        } else {
<span class="nc" id="L1137">            throw new IllegalArgumentException(value + &quot; is not a valid value for attribute &quot; + ATTRIBUTE_NAMES[attrId]);</span>
        }
<span class="nc" id="L1139">    }</span>

    /**
     * Removes the specified attribute
     *
     * @param attrId The attribute Id (One of the ATTR_ constants)
     */
    public void removeAttributeById(int attrId) {
<span class="nc bnc" id="L1147" title="All 4 branches missed.">        if ((attrId &lt; 0) || (attrId &gt;= ATTRIBUTE_NAMES.length)) {</span>
<span class="nc" id="L1148">            throw new IllegalArgumentException(&quot;Attribute Id must be in the range of 0-&quot; + (ATTRIBUTE_NAMES.length - 1));</span>
        }
<span class="nc" id="L1150">        removeAttribute(Integer.valueOf(attrId));</span>
<span class="nc" id="L1151">    }</span>

    /**
     * Returns a list of supported attributes for this tag. Note that the list does not include the core attributes that are supported on almost all tags
     *
     * @return a list of supported attributes for this tag
     */
    public String getSupportedAttributesList() {
<span class="nc bnc" id="L1159" title="All 4 branches missed.">        if ((id &lt; 0) || (id &gt;= TAG_ATTRIBUTES.length)) {</span>
<span class="nc" id="L1160">            return &quot;Unknown&quot;;</span>
        }
<span class="nc" id="L1162">        String list = &quot;&quot;;</span>
<span class="nc bnc" id="L1163" title="All 2 branches missed.">        for (int a = 0; a &lt; TAG_ATTRIBUTES[id].length; a++) {</span>
<span class="nc" id="L1164">            list += ATTRIBUTE_NAMES[TAG_ATTRIBUTES[id][a]] + &quot;,&quot;;</span>
        }
<span class="nc bnc" id="L1166" title="All 2 branches missed.">        if (supportsCoreAttributes()) {</span>
<span class="nc bnc" id="L1167" title="All 2 branches missed.">            for (int a = 0; a &lt; COMMON_ATTRIBUTES.length; a++) {</span>
<span class="nc" id="L1168">                list += ATTRIBUTE_NAMES[COMMON_ATTRIBUTES[a]] + &quot;,&quot;;</span>
            }
        }

<span class="nc bnc" id="L1172" title="All 2 branches missed.">        if (list.endsWith(&quot;,&quot;)) {</span>
<span class="nc" id="L1173">            list = list.substring(0, list.length() - 1);</span>
        }
<span class="nc bnc" id="L1175" title="All 2 branches missed.">        if (list.equals(&quot;&quot;)) {</span>
<span class="nc" id="L1176">            list = &quot;None&quot;;</span>
        }
<span class="nc" id="L1178">        return list;</span>
    }

    /**
     * Verifies that the specified value conforms with the attribute's type restrictions.
     * This basically checks the attribute type and according to that checks the value.
     *
     * @param attrId The attribute ID
     * @param value  The value to be checked
     * @return true if the value is valid for this attribute, false otherwise
     */
    private boolean isValid(int type, String value) {
<span class="nc bnc" id="L1190" title="All 2 branches missed.">        if (value == null) { // a null value is invalid for all attributes</span>
<span class="nc" id="L1191">            return false;</span>
        }
<span class="nc bnc" id="L1193" title="All 2 branches missed.">        if (ALLOWED_STRINGS[type] != null) {</span>
<span class="nc" id="L1194">            return verifyStringGroup(value, ALLOWED_STRINGS[type]);</span>
        }

<span class="nc bnc" id="L1197" title="All 5 branches missed.">        switch (type) {</span>
            case TYPE_NUMBER:
<span class="nc" id="L1199">                return verify(value, DIGITS, null);</span>
            case TYPE_PIXELS_OR_PERCENTAGE:
<span class="nc bnc" id="L1201" title="All 2 branches missed.">                if (value.endsWith(&quot;%&quot;)) { //percentage</span>
<span class="nc" id="L1202">                    value = value.substring(0, value.length() - 1);</span>
<span class="nc bnc" id="L1203" title="All 2 branches missed.">                } else if (value.endsWith(&quot;px&quot;)) { //pixels</span>
<span class="nc" id="L1204">                    value = value.substring(0, value.length() - 2);</span>
                }
<span class="nc" id="L1206">                return verify(value, DIGITS, null);</span>
            case TYPE_CHAR:
<span class="nc" id="L1208">                return verify(value, DIGITS | ABC, null, 1, 1);</span>
            case TYPE_COLOR:
<span class="nc bnc" id="L1210" title="All 2 branches missed.">                if (value.length() == 0) {</span>
<span class="nc" id="L1211">                    return false;</span>
                }
<span class="nc bnc" id="L1213" title="All 2 branches missed.">                if (value.charAt(0) != '#') {</span>
<span class="nc" id="L1214">                    return verifyStringGroup(value, COLOR_STRINGS);</span>
                } else {
<span class="nc" id="L1216">                    return verify(value.substring(1), HEX, null, 3, 6); //Color can also be #rgb which means #rrggbb (as for 4,5 chars these will also be tolerated)</span>
                }

            default:
<span class="nc" id="L1220">                return true;</span>
        }
    }

    /**
     * A convenience method for verifying strings with no length restrictions
     *
     * @param value        The string to be checked
     * @param allowedMask  DIGITS or HEX or ABC or a combination of those
     * @param allowedChars Characters that are allowed even if they don't conform to the mask
     * @return true if the string is valid, false otherwise.
     */
    private boolean verify(String value, int allowedMask, char[] allowedChars) {
<span class="nc" id="L1233">        return verify(value, allowedMask, allowedChars, -1, -1);</span>
    }

    /**
     * Verifies that the specified string conforms with the specified restrictions.
     *
     * @param value        The string to be checked
     * @param allowedMask  DIGITS or HEX or ABC or a combination of those
     * @param allowedChars Characters that are allowed even if they don't conform to the mask
     * @param minLength    Minimum length
     * @param maxLength    Maximum length
     * @return true if the string is valid, false otherwise.
     */
    private boolean verify(String value, int allowedMask, char[] allowedChars, int minLength, int maxLength) {
<span class="nc bnc" id="L1247" title="All 4 branches missed.">        if ((minLength != -1) &amp;&amp; (value.length() &lt; minLength)) {</span>
<span class="nc" id="L1248">            return false;</span>
        }
<span class="nc bnc" id="L1250" title="All 4 branches missed.">        if ((maxLength != -1) &amp;&amp; (value.length() &gt; maxLength)) {</span>
<span class="nc" id="L1251">            return false;</span>
        }


<span class="nc" id="L1255">        int i = 0;</span>
<span class="nc bnc" id="L1256" title="All 2 branches missed.">        while (i &lt; value.length()) {</span>
<span class="nc" id="L1257">            boolean found = false;</span>
<span class="nc" id="L1258">            char ch = value.charAt(i);</span>
<span class="nc bnc" id="L1259" title="All 2 branches missed.">            if ((allowedMask &amp; HEX) != 0) {</span>
<span class="nc bnc" id="L1260" title="All 12 branches missed.">                if (((ch &gt;= '0') &amp;&amp; (ch &lt;= '9')) ||</span>
                        ((ch &gt;= 'A') &amp;&amp; (ch &lt;= 'F')) ||
                        ((ch &gt;= 'a') &amp;&amp; (ch &lt;= 'f'))) {
<span class="nc" id="L1263">                    found = true;</span>
                }
            }

<span class="nc bnc" id="L1267" title="All 2 branches missed.">            if ((allowedMask &amp; DIGITS) != 0) {</span>
<span class="nc bnc" id="L1268" title="All 4 branches missed.">                if (((ch &gt;= '0') &amp;&amp; (ch &lt;= '9'))) {</span>
<span class="nc" id="L1269">                    found = true;</span>
<span class="nc bnc" id="L1270" title="All 6 branches missed.">                } else if ((i == 0) &amp;&amp; ((ch == '-') || (ch == '+'))) { // Sign is allowed as the first character</span>
<span class="nc" id="L1271">                    found = true;</span>
                }
            }

<span class="nc bnc" id="L1275" title="All 4 branches missed.">            if ((!found) &amp;&amp; ((allowedMask &amp; ABC) != 0)) {</span>
<span class="nc bnc" id="L1276" title="All 8 branches missed.">                if (((ch &gt;= 'a') &amp;&amp; (ch &lt;= 'z')) ||</span>
                        ((ch &gt;= 'A') &amp;&amp; (ch &lt;= 'Z'))) {
<span class="nc" id="L1278">                    found = true;</span>
                }
            }

<span class="nc bnc" id="L1282" title="All 4 branches missed.">            if ((!found) &amp;&amp; (allowedChars != null)) {</span>
<span class="nc" id="L1283">                int c = 0;</span>
<span class="nc bnc" id="L1284" title="All 4 branches missed.">                while ((!found) &amp;&amp; (c &lt; allowedChars.length)) {</span>
<span class="nc bnc" id="L1285" title="All 2 branches missed.">                    if (ch == allowedChars[c]) {</span>
<span class="nc" id="L1286">                        found = true;</span>
                    } else {
<span class="nc" id="L1288">                        c++;</span>
                    }
                }
            }

<span class="nc bnc" id="L1293" title="All 2 branches missed.">            if (!found) {</span>
<span class="nc" id="L1294">                return false;</span>
            }
<span class="nc" id="L1296">            i++;</span>

<span class="nc" id="L1298">        }</span>
<span class="nc" id="L1299">        return true;</span>
    }

    /**
     * Verifies that the specified string equals to one of the allowed strings
     *
     * @param value   The string to be checked
     * @param allowed The list of allowed strings
     * @return true if the string equals to one of the allowed, false otherwise
     */
    boolean verifyStringGroup(String value, String[] allowed) {
<span class="nc bnc" id="L1310" title="All 2 branches missed.">        for (int i = 0; i &lt; allowed.length; i++) {</span>
<span class="nc bnc" id="L1311" title="All 2 branches missed.">            if (value.equalsIgnoreCase(allowed[i])) {</span>
<span class="nc" id="L1312">                return true;</span>
            }
        }
<span class="nc" id="L1315">        return false;</span>
    }

    /**
     * Returns this HTMLElement's tag name
     *
     * @return the HTMLElement's tag name
     */
    public String getTagName() {
<span class="nc" id="L1324">        String name = super.getTagName();</span>

<span class="nc bnc" id="L1326" title="All 2 branches missed.">        if (name != null) { //unsupported tags</span>
<span class="nc" id="L1327">            return name;</span>
        }
//        if ((id&lt;0) || (id&gt;=TAG_NAMES.length)) {
//            return &quot;Unsupported&quot;;
//        }
<span class="nc" id="L1332">        return TAG_NAMES[id];</span>
    }

    /**
     * Returns this HTMLElement's ID
     *
     * @return the HTMLELement's ID
     */
    public int getTagId() {
<span class="nc" id="L1341">        return id;</span>
    }

    /**
     * Sets this HTMLElement's ID
     *
     * @param tagId The tag ID to set, one of the TAG_* constants (Not to be confused with the id attribute)
     */
    protected void setTagId(int tagId) {
<span class="nc" id="L1350">        this.id = tagId;</span>
<span class="nc" id="L1351">    }</span>

    /**
     * Returns an HTMLElement's child by a tag ID (One of the TAG_* constants)
     *
     * @param tagId The child's tag ID, one of the TAG_* constants (Not to be confused with the id attribute)
     * @return the first child with the specified ID, or null if not found
     */
    public HTMLElement getFirstChildByTagId(int tagId) {
<span class="nc" id="L1360">        Vector children = getChildren();</span>
<span class="nc bnc" id="L1361" title="All 2 branches missed.">        if (children == null) {</span>
<span class="nc" id="L1362">            return null;</span>
        }
<span class="nc" id="L1364">        int i = 0;</span>
<span class="nc" id="L1365">        HTMLElement found = null;</span>
<span class="nc bnc" id="L1366" title="All 4 branches missed.">        while ((found == null) &amp;&amp; (i &lt; children.size())) {</span>
<span class="nc" id="L1367">            HTMLElement child = (HTMLElement) children.elementAt(i);</span>
<span class="nc bnc" id="L1368" title="All 2 branches missed.">            if (child.getTagId() == tagId) {</span>
<span class="nc" id="L1369">                found = child;</span>
            } else {
<span class="nc" id="L1371">                i++;</span>
            }
<span class="nc" id="L1373">        }</span>
<span class="nc" id="L1374">        return found;</span>

    }

    /**
     * Returns an HTMLElement's attribute by the attribute's ID (One of the ATTR_* constants)
     *
     * @param id The attribute's ID
     * @return the attribute with the specified ID, or null if not found
     */
    public String getAttributeById(int id) {
<span class="nc" id="L1385">        Hashtable attributes = getAttributes();</span>
<span class="nc bnc" id="L1386" title="All 2 branches missed.">        if (attributes == null) {</span>
<span class="nc" id="L1387">            return null;</span>
        }
<span class="nc" id="L1389">        return (String) attributes.get(Integer.valueOf(id));</span>
    }

    /**
     * {{@inheritDoc}}
     */
    public String toString() {
<span class="nc" id="L1396">        return toString(&quot;&quot;);</span>
    }


    /**
     * Returns the attribute name of the requested attribute
     *
     * @param attrKey The attribute key, which is typically an Integer object made of its int attrId
     * @return the attribute name of the requested attribute
     */
    public String getAttributeName(Integer attrKey) { // This method is not static since it needs to be overriden in CSSElement
<span class="nc" id="L1407">        return ATTRIBUTE_NAMES[attrKey.intValue()];</span>
    }

    public String getAttribute(String name) {
<span class="nc" id="L1411">        Hashtable attributes = getAttributes();</span>
<span class="nc bnc" id="L1412" title="All 2 branches missed.">        if (attributes != null) {</span>
<span class="nc bnc" id="L1413" title="All 2 branches missed.">            for (int i = 0; i &lt; ATTRIBUTE_NAMES.length; i++) {</span>
<span class="nc bnc" id="L1414" title="All 2 branches missed.">                if (name.equalsIgnoreCase(ATTRIBUTE_NAMES[i])) {</span>
<span class="nc" id="L1415">                    return getAttributeById(i);</span>
                }
            }
        }
<span class="nc" id="L1419">        return null;</span>
    }

    /**
     * A recursive method for creating a printout of a full tag with its entire hierarchy.
     * This is used by the public method toString().
     *
     * @param spacing Increased by one in each recursion phase to provide with indentation
     * @return the printout of this tag
     */
    public String toString(String spacing) {
<span class="nc" id="L1430">        String str = spacing;</span>
<span class="nc bnc" id="L1431" title="All 2 branches missed.">        if (!isTextElement()) {</span>
<span class="nc" id="L1432">            str += &quot;&lt;&quot; + getTagName();</span>
<span class="nc" id="L1433">            Hashtable attributes = getAttributes();</span>
<span class="nc bnc" id="L1434" title="All 2 branches missed.">            if (attributes != null) {</span>
<span class="nc bnc" id="L1435" title="All 2 branches missed.">                for (Enumeration e = attributes.keys(); e.hasMoreElements(); ) {</span>
<span class="nc" id="L1436">                    Integer attrKey = (Integer) e.nextElement();</span>
<span class="nc" id="L1437">                    String attrStr = getAttributeName(attrKey);</span>

<span class="nc" id="L1439">                    String val = (String) attributes.get(attrKey);</span>
<span class="nc" id="L1440">                    str += &quot; &quot; + attrStr + &quot;='&quot; + val + &quot;' (&quot; + attrKey + &quot;)&quot;;</span>
<span class="nc" id="L1441">                }</span>
            }
<span class="nc" id="L1443">            str += &quot;&gt;\n&quot;;</span>

<span class="nc" id="L1445">            Vector children = getChildren();</span>
<span class="nc bnc" id="L1446" title="All 2 branches missed.">            if (children != null) {</span>
<span class="nc bnc" id="L1447" title="All 2 branches missed.">                for (int i = 0; i &lt; children.size(); i++) {</span>
<span class="nc" id="L1448">                    str += ((HTMLElement) children.elementAt(i)).toString(spacing + ' ');</span>
                }
            }
<span class="nc" id="L1451">            str += spacing + &quot;&lt;/&quot; + getTagName() + &quot;&gt;\n&quot;;</span>
<span class="nc" id="L1452">        } else {</span>
<span class="nc" id="L1453">            str += &quot;'&quot; + getText() + &quot;'\n&quot;;</span>
        }
<span class="nc" id="L1455">        return str;</span>
    }

    /**
     * Returns a vector of Components associated with this HTMLElement
     *
     * @return a vector of Components associated with this HTMLElement
     */
    Vector getUi() {
<span class="nc bnc" id="L1464" title="All 2 branches missed.">        if (comps == null) { // If no UI exists this may be a tag with children that do have UI, such as TAG_A</span>
<span class="nc" id="L1465">            comps = new Vector();</span>
<span class="nc" id="L1466">            Vector children = getChildren();</span>
<span class="nc bnc" id="L1467" title="All 2 branches missed.">            if (children != null) {</span>
<span class="nc bnc" id="L1468" title="All 2 branches missed.">                for (Enumeration e = children.elements(); e.hasMoreElements(); ) {</span>
<span class="nc" id="L1469">                    HTMLElement child = (HTMLElement) e.nextElement();</span>
<span class="nc" id="L1470">                    Vector childUI = child.getUi();</span>
<span class="nc bnc" id="L1471" title="All 2 branches missed.">                    for (Enumeration e2 = childUI.elements(); e2.hasMoreElements(); ) {</span>
<span class="nc" id="L1472">                        comps.addElement(e2.nextElement());</span>
                    }
<span class="nc" id="L1474">                }</span>
            }
<span class="nc" id="L1476">            calculatedUi = true;</span>
        }
<span class="nc" id="L1478">        return comps;</span>
    }

    /**
     * Causes a recalculation of the UI, if the UI of this element was deduced from children components
     */
    void recalcUi() {
<span class="nc bnc" id="L1485" title="All 2 branches missed.">        if (calculatedUi) {</span>
<span class="nc" id="L1486">            comps = null;</span>
<span class="nc" id="L1487">            calculatedUi = false;</span>
        }
<span class="nc" id="L1489">    }</span>

    /**
     * {{@inheritDoc}}
     */
    public void removeChildAt(int index) { // Overiding is done to clear the associated components vector of the child
<span class="nc" id="L1495">        HTMLElement child = (HTMLElement) getChildAt(index);</span>
<span class="nc" id="L1496">        child.clearAssociatedComponents();</span>
<span class="nc" id="L1497">        super.removeChildAt(index);</span>
<span class="nc" id="L1498">    }</span>

    private void getDescendantsByTagIdInternal(Vector v, int tagId, int depth) {
<span class="nc" id="L1501">        int i = 0;</span>
<span class="nc" id="L1502">        Vector children = getChildren();</span>
<span class="nc bnc" id="L1503" title="All 2 branches missed.">        if (children != null) {</span>
<span class="nc bnc" id="L1504" title="All 2 branches missed.">            while (i &lt; children.size()) {</span>
<span class="nc" id="L1505">                HTMLElement child = (HTMLElement) children.elementAt(i);</span>
<span class="nc bnc" id="L1506" title="All 2 branches missed.">                if (depth &gt; 0) {</span>
<span class="nc" id="L1507">                    child.getDescendantsByTagIdInternal(v, tagId, depth - 1);</span>
                }
<span class="nc bnc" id="L1509" title="All 2 branches missed.">                if (child.getTagId() == tagId) {</span>
<span class="nc" id="L1510">                    v.addElement(child);</span>
                }
<span class="nc" id="L1512">                i++;</span>
<span class="nc" id="L1513">            }</span>
        }

<span class="nc" id="L1516">    }</span>

    /**
     * Returns all descendants with the specified tag id
     *
     * @param tagId The tag ID to look for, one of the TAG_* constants (Not to be confused with the id attribute)
     * @param depth The search depth (1 - children, 2 - grandchildren .... DEPTH_INFINITE - for all descendants)
     * @return A vector containing descendants with the specified tag id
     */
    public Vector getDescendantsByTagId(int tagId, int depth) {
<span class="nc bnc" id="L1526" title="All 2 branches missed.">        if (depth &lt; 1) {</span>
<span class="nc" id="L1527">            throw new IllegalArgumentException(&quot;Depth must be 1 or higher&quot;);</span>
        }
<span class="nc bnc" id="L1529" title="All 2 branches missed.">        if (isEmpty()) {</span>
<span class="nc" id="L1530">            return null;</span>
        }
<span class="nc" id="L1532">        Vector v = new Vector();</span>
<span class="nc" id="L1533">        getDescendantsByTagIdInternal(v, tagId, depth);</span>
<span class="nc" id="L1534">        return v;</span>
    }

    /**
     * Returns all descendants with the specified tag id
     *
     * @param tagId The tag ID to look for, one of the TAG_* constants (Not to be confused with the id attribute)
     * @return A vector containing descendants with the specified tag id
     */
    public Vector getDescendantsByTagId(int tagId) {
<span class="nc" id="L1544">        return getDescendantsByTagId(tagId, DEPTH_INFINITE);</span>
    }

    /**
     * Returns true if this element is the first non-text child of its parent
     * This is used internally for the :first-child pseudo class
     *
     * @return true if this element is the first non-text child of its parent
     */
    boolean isFirstChild() {
<span class="nc bnc" id="L1554" title="All 2 branches missed.">        if ((HTMLComponent.PROCESS_HTML_MP1_ONLY) || (isTextElement())) { // :first-child is not supported in HTML-MP1</span>
<span class="nc" id="L1555">            return false;</span>
        }
<span class="nc" id="L1557">        HTMLElement parent = (HTMLElement) getParent();</span>
<span class="nc bnc" id="L1558" title="All 2 branches missed.">        if (parent != null) {</span>
<span class="nc bnc" id="L1559" title="All 2 branches missed.">            for (Element e : parent) {</span>
<span class="nc" id="L1560">                HTMLElement elem = (HTMLElement) e;</span>
<span class="nc bnc" id="L1561" title="All 2 branches missed.">                if (elem == this) {</span>
<span class="nc" id="L1562">                    return true;</span>
                }
<span class="nc bnc" id="L1564" title="All 2 branches missed.">                if (!elem.isTextElement()) {</span>
<span class="nc" id="L1565">                    return false;</span>
                }
<span class="nc" id="L1567">            }</span>
        }
<span class="nc" id="L1569">        return false;</span>
    }

}

</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>